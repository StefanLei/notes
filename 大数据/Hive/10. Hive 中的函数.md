#### 标准函数

用户自定义函数（UDF）这个术语在狭义的概念上，还表示一行的数据中的一列或者多列作为参数，然后返回结果是一个值的函数。

大多数函数都是属于这样的类型。



#### 聚合函数

另一种函数是聚合函数，所有的聚合函数，用户自定义函数和内置函数。都统称为用户自定义聚合函数（UDAF）。聚合函数接受从零行到多行的零个到多个列，然后返回单一值。这样的例子包括数学函数 sum()

返回所有求和的值，或者 avg() 计算所有的输入的平均值。聚合方法通常和 group by 语句组合使用。





#### 生成表函数

Hive 所支持的第3类函数就是生成函数，和其他的函数类别一样，所有的表生成函数，包括用户自定义的和内置的，都统称为用户自定义函数。（UDTF）

表生成函数接受零个或者多个输入，然后产生多列或者多行输出。

---

#### UDF 函数使用

==编写 Python 代码==

```python
import sys
for line in sys.stdin:
    # line 是字符串 例如 Mary	F 中间是 \t
    # line 里面是传递进来的指定列的一行。默认每一列之间是用 \t 分割，即使我们定义的表是其他的
    # 但是这里如果要分割的话，都是用 \t
    line = line.split('\t')
    name = line[0]
    # 输出，我们也要输出字符串
    print(name)

    # 如果有多个字符串输出，我们可以这样,就是输出也是字符串，列之间用 \t 连接
    print('\t'.join([line[0],line[1]]))
```

==然后把 Python 代码传到Hive服务端==

==然后在Hive中添加这个函数==

```sh
# 注意：每次修改 udf.py 后，都要重新 add
add file /root/udf.py
```

==然后在 Hive 中使用==

```sh
# transform里面就是传递给 udf 的值，可以一列，可以多列。多列之间用 \t 隔开
# 后面的 as，是给输出的列取别名。as 数量可以少于 python 里面输出的数量。
select transform(name) using "/opt/Python3/bin/python3.6m udf.py" as a,b from test;
```



